<div class="create-container">
    <div class="header">
        <h2>Add Questions to Exam</h2>
        <button type="button" routerLink="/exams" class="btn btn-secondary">Back to List</button>
    </div>

    <!-- Select Banks -->
<div class="form-section">
  <h3>Select Question Banks</h3>
  <div class="form-group">
    <label>Choose Banks</label>

    <div class="bank-list">
      @for (bank of banks; track $index) {
        <div class="form-check">
          <input
            type="checkbox"
            class="form-check-input"
            [id]="bank.id"
            [value]="bank.id"
            (change)="onBankChecked($event, bank.id!)"
            [checked]="selectedBankIds.includes(bank.id!)"
          />
          <label class="form-check-label" [for]="bank.id">
            {{ bank.name }}
          </label>
        </div>
      }
    </div>
  </div>

  <button class="btn btn-primary mt-2" (click)="loadQuestions()">Load Questions</button>
</div>


    <!-- Questions Table -->
  @if(questions.length > 0) { <div class="form-section" >
        <h3>Questions from Selected Banks</h3>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Select</th>
                    <th>Title</th>
                    <th>Type</th>
                    <th>Answers</th>
                </tr>
            </thead>
            <tbody>
                @for (question of questions; track $index) {
                <tr>
                    <td>
                        <input type="checkbox" [(ngModel)]="question.isSelected" />
                    </td>
                    <td>{{ question.tittle }}</td>
                    <td>{{ question.questionType }}</td>
                    <td>
                        <ul>
                            @for (ans of question.questionAnswers; track $index) {
                            <li>{{ ans.answer }}</li>
                            }
                        </ul>
                    </td>
                </tr>
                }
            </tbody>
        </table>

        <button class="btn btn-success" [disabled]="!hasSelectedQuestions() || loading"
            (click)="addSelectedQuestions()">
            @if (loading) {
            <span class="spinner"></span>
            Adding...
            } @else {
            Add Selected Questions
            }
        </button>
    </div>}

    <!-- Loading Overlay -->
    @if (loading) {
    <div class="loading-overlay">
        <div class="loading-spinner">Processing...</div>
    </div>
    }
</div>