<div class="list-container" style="width: 100%;">

  <!-- Delete confirmation -->
  @if (showDeleteConfirm) {
  <div class="delete-confirm-card">
    <p>Are you sure you want to delete <strong>{{ examToDelete.name }}</strong>?</p>
    <div class="delete-confirm-actions">
      <button class="btn btn-secondary" (click)="cancelDelete()">No</button>
      <button class="btn btn-danger" (click)="deleteExam()">Yes</button>
    </div>
  </div>
  }

  <!-- Search and Create -->
  <div class="toolbar">
    <input 
      type="text" 
      [(ngModel)]="search" 
      placeholder="Search exams..." 
      class="search-input"
      (keyup.enter)="onSearchChange()" />
    <button class="btn btn-search" (click)="onSearchChange()" title="Search">
      <i class="bi bi-search"></i>
    </button>

    <button routerLink="/exams/create" class="btn btn-create" title="Create">
      <i class="bi bi-plus-circle me-1"></i> Create
    </button>
  </div>

  <!-- Loading -->
  @if (loading) {
  <div class="loading-container">
    <div class="spinner"></div>
    <p class="loading-text">Loading...</p>
  </div>
  }

  <!-- Table -->
  @if (!loading) {
    @if (exams.length > 0) {
    <table class="table" style="width: 100%;">
      <thead>
        <tr>
          <th>#</th>
          <th>Name</th>
          <th>Time (min)</th>
          <th>Score</th>
          <th>Active</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        @for (exam of exams; track exam.id; let i = $index) {
        <tr>
          <td>{{ (pageIndex - 1) * pageSize + i + 1 }}</td>
          <td>{{ exam.name }}</td>
          <td>{{ exam.timeExam }}</td>
          <td>{{ exam.score }}</td>
          <td>
            <span [class.text-success]="exam.isActive" [class.text-danger]="!exam.isActive">
              {{ exam.isActive ? 'Yes' : 'No' }}
            </span>
          </td>
          <td class="actions">
            <button [routerLink]="['/exams/updateQuestionExam', exam.id]" class="btn btn-edit" title="Edit">
              <i class="bi bi-journal-text"></i>
            </button>
            <button [routerLink]="['/exams/update', exam.id]" class="btn btn-edit" title="Edit">
              <i class="bi bi-pencil"></i>
            </button>
            
            <button (click)="confirmDelete(exam)" class="btn btn-delete" title="Delete">
              <i class="bi bi-trash"></i>
            </button>
          </td>
        </tr>
        }
      </tbody>
    </table>

    <!-- Pagination -->
    @if (totalCount > pageSize) {
    <div class="pagination">
      <button 
        class="btn btn-previous" 
        [disabled]="pageIndex === 1" 
        (click)="onPageChange(pageIndex - 1)">
        Previous
      </button>

      <span class="page-info">Page {{ pageIndex }} of {{ totalPages }}</span>

      <button 
        class="btn btn-next" 
        [disabled]="pageIndex === totalPages" 
        (click)="onPageChange(pageIndex + 1)">
        Next
      </button>
    </div>
    }
  } @else {
    <div class="no-data-message">
      <p>No exams found.</p>
    </div>
  }
}
</div>
